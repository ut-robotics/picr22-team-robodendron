== Team presentation
*Gautier Reynes:* in charge of Mechanics and Programming, support for Electronics. +
*Malcom  Radigon:* in charge of Programming. +
*Léon Glorieux:* in charge of Mechanics. +
*Nathan Mison:* in charge of Electronics. +

== Fusion 360 assembly link

https://a360.co/3Thbv4A +

== Programming

*External libraries* +

numpy - Calculation and data processing +
math - Trigonometric functions +
enum - State of the robot +
pyserial - Serial communication +
websocket - Connect to the server of referee referee command +
json - access the data of referee command +
threading - Create thread for each action of the robot +
sys - Control thread +
pickle - Store the color configuration +
cv2 - image processing +
input/get_gamepad - communication with the gamepad controller +
pyrealsense2 - Realsense camera +

*Game logic* +
	
The robot starts when the referee sends the command with the target basket. It will rotate until it sees a ball. 
If it sees a ball, it drives towards it until it is close enough. Once it is close enough, it orbits around the ball until it is aligned with the ball and the target basket. 
It estimates the distance with the basket and engages the thrower motor accordingly. It goes forward to throw the ball. Then it starts again to search a ball by rotating.
If at any moment , the ball is lost then it rotates again to find a new one. +

*Code structure* +

image::code_diagram.png[]

*Code review* +

The logic of the movement of the robots was good since the robot was moving with smooth trajectory towards the ball and the alignment with the baskets were smooth as well. The main improvement is in the machine vison part. The color detection and the depth estimation could be improved to get a better accuracy when aligning the ball and the basket so we can score more often. The robot got issues as well to detect the balls on the field when they were too far from the robot. This can as well be improved by adjusting the OpenCV part. The robot didn't have the logic to ignore the balls when they are outside of the field or to avoid the collision with the baskets. This cause a lot of penalty during competition, and this is something important to implement. This can be done as well by developing more the machine vision part. The logic to search the ball can be improve by making straight trajectory between the opponent basket the team basket. This would allow to find all the balls on the filed even if the last ball remaining is at the opposite side. +

== Mechanics

Here's a picture of our robot in its final state, with all the parts fully assembled. It's quite big as we had to play with
the test robot electronics. In a way, it's more practical since we have room to fit all the cables... We struggled with the
more compact test robot we had, so we figured we'd go big for our own. 

image::robot.jpg["The robot"]

== Electronics

The final electronics are the test electronics. The two servos on the thrower are not implemented in the code so there is no need for them to be linked to the mainboard. The pcb was not finished for multiples reasons, first assembling the test electronics took longer than expected because the test robot we had was very small and not adapted for the test electronics, it was made for a pcb. Then the mainboard and the voltage regulator were short circuited, had to be replaced reprogrammed and refitted on the test robot leading to a month of delay. Finally, I also learned how to design a pcb while making it, leading to some mistakes in designing that cost time that I no longer had. +

The PCB was not finished in time, but even so there was nothing to connect the two servos on the thrower, so adding the connections would have been better. We also noticed that having a larger robot makes fitting the test electronics in it much easier. With the test robot we really struggled as it was very small, but our new robot it was much smoother. +

As can be seen on this picture, thanks to spacious design of the robot, there is ample room for all the components and the cable management is clean. This is also helped thanks to connectors of the battery being embedded in the design and not dangling everywhere. +
image::cabling.jpg[]

I worked on the electronics, I therefore mostly learned how to design a pcb. Unfortunately, most of the mistakes chere either out of my control, like the test robot being to small or the mainboard shortcircuiting for no apparent reason. But since I now know how to design a pcb if I were to do the same thing again it would probably work.
I liked being able to work manually on the robot. I however disliked the lack of instructions on how to design teh pcb. I felt like both learning how to do it and doing it at the same time led to a very tight schedule. I had the impression that this course is not for learning but for doing something that is already learned, which is a shame.
For next year students I definetly advise to choose the largest robot at the beginning of the year as it leads to a much easier time fixing the test electronics. I would also recommend them to design their own robot with the test electronics in mind, so that no team the year after suffers from haing unfixable test electronics to the robot.
And for the instructors I would like more documentation on altium and how to design the pcb for this application, I think this would both accelerate the progression curve of people learning how to design pcbs. It would also probably lower the workload on the instructors as a part of the solicitation would be solved by the sudents themselves.
I also think that the fixed points awarded for each task does not adequatly reflect the workload. For example attaching the test electronics gives the same amount to everyone, but a team starting with a large robot and clean electronics has a much easier time doing this that one starting with a small robot and cabling that has to be done over again. +


== Personal comments

*Gautier:* I personally worked on the robot's chassis (base chassis, camera mounts, anything that holds
the robot's parts together...), as well as some of the software (gamepad control, vision logic... I gave Malcom
some support with depth sensing for the robot's aim at the hoops...).
This project requires good skills in any topic of mechatronics, and depending on how you manage your team,
and depending on how much your teammates want to be involved, it can go south pretty easily. Deadlines aren't short
you get the sufficient amount of time to get things done, but falling in the trap of wasting crucial time on useless things
is so easy...

The TAs are very demanding, so you should be very flexible with your solutions, and anticipate all
tiny attention mistakes in either your code, your CAD and electronics. Some details might seem like a pain, but most of the time
it's all about best practices for later work in the industry I guess.

*Malcom:*

*Léon:*

*Nathan:*

== Blog

== Saturday 2022-09-03

Day 1 of project bootcamp. The whole team was familiarizing with the project's
structure and started working with other contestants than Robodendron's members.

Some worked on electronics while others played with mechanics and software.

== Sunday 2022-09-04

Day 2 of the project's bootcamp. The tasks were swapped between electronics, mechanics
and software development so that the whole team members could be introduced to the
concepts to be used in this project.

=== Monday 2022-09-05
Decide the tasks all together +
*Malcom:* start working on camera to find the ball (2h) +
*Leon:* start working on the test robot and get the sizes with the calliper, start thinking about a first launcher (2h) +
*Nathan:* soldering of missing parts from the test robot (2h) +
*Gautier:* started designing the ramp for the thrower with right ejection angle. (2h) +

=== Thursday 2022-09-08
*Malcom:* work on the omni wheels, to make them rotate (2h) +
*Leon:* build the thrower and get used to fusion (2h) +
*Nathan:* finished the soldering, improved some of the connections, tried to make the motors work (2h) +
*Gautier:* More tweaking on the thrower ramp (2h) +


=== Monday 2022-09-12
*Malcom:* work on the mapping of the omniwheels to give a direction, and start the programation of the motion (2h) +
*Leon:* finish the launcher (2h) +
*Nathan:* the motors worked it was due to some cabling error (2h) +
*Gautier:* final work on the ramp design with real test robot CAD (2h) +

=== Thursday 2022-09-15
...

=== Monday 2022-09-19
Progress presentation.

== Thursday 2022-09-22
*Malcom:*
*Leon:* Design of a new fixture component to attach the new omniwheels to the
motor axles. This new design should be much easier to attach to the wheel and 
it should grip the motor axles much better. (2h) +
*Nathan:* Cable management on the test robot. (2h) +
*Gautier:* Design of the new omniwheels (one single piece should be enough as
opposed to the two parts taking the bearings and their axles in "sandwich"). (2h) +

== Monday 2022-09-26
*Malcom:* Writing a code to spin the robot and stop when the ball is detected (2h) +
*Leon:*  Improvements on the thrower's structure with standoffs. The whole assembly should be much more rigid. (3h) +
*Nathan:*  Fixed the motor controllers to the frame (1h); started learning about PCB design (1h30) +
*Gautier:* Print of wheel prototypes to figure out the best tolerance settings for press fitting the roller axles. (3h) +

== Thursday 2022-09-29
*Malcom:* Writing a code that not only looks for the ball by spinning, but also moves the robot
towards the ball with a speed proportional to the distance to the target. (2h) +
*Leon:* Improvement ont the thrower (tolerances, holes...) (3h) +
*Nathan:* Continued learning about PCBs and searched some components (2h30) +
*Gautier:* Design, 3D printing and installation of the new omniwheel on the test robot.
Some heated inserts are installed to provide better fixture. Two designs for wheel hubs (fixture to the motor shafts) were
also attempted. A new single-piece design was born from issues with two-part hub/wheel. (6h30) +

== Monday 2022-10-3
Progress presentation. +
*Gautier:* Print of the latest omniwheel design integrating both the wheel and the hub in one piece. (2h) +

*Nathan:* Did Pcb footprint library of the mainboard (2h) +

== Thursday 2022-10-6
*Nathan:* Did Pcb schematics library of the mainboard (2h) +

== Monday 2022-10-10
*Leon:* Thinking about a way to modify the launcher to enable throwing angle adjustment. (1,5h) +
*Nathan:* Tried to join both schematics and footprint (2h) +

== Thursday 2022-10-13
*Leon:* 3D modelling of the adjustable solution. (3h) +
*Nathan:* Found some schematics libraries (2h) +

== Sunday 2022-10-16
*Gautier:* 3D printing parts of the fixed angle thrower + assembly of the new omniwheels. (3h) +

== Monday 2022-10-17
Progress presentation +

== Thursday 2022-10-20
*Nathan:* Electronics tests with thrower: burned mainboard (2h) +
*Léon:* work on the thrower motorisation (3h) +


== Monday 2022-10-24
*Nathan:* Tried to find mainboard problem (4h) +
*Léon:* add new features to the thrower, (2h) and thrower motorisation (1h) +
*Gautier:* first (unsuccessful) attempt at soldering the SMD jumper resistors on the new MCU (2h) +

Tuesday 2022-10-25
*Gautier:* The new MCU is ready, the solders are working although they don't look too preety (2h) +
== Thursday 2022-10-27
*Nathan:* Fixed problem, noticed voltage regulator was burned too (2h) +
*Léon:* setup and send review notice on the elements which are almost finished. Do the excel for the progress. +

== Monday 2022-10-31
Progress presentation+

*Léon:* correct the problems of the reviewed design, and discussion on the bad mechanical designs (3h) +
*Gautier:* starting designing the chassis's base plate (2,5h) +

== Thursday 2022-11-3
*Léon:* work on the redesign of the thrower (3h) +
*Nathan:* Made the voltage regulator work, created some new cables (2h) +
*Malcom:* connecting the robot back after the problem encountered. (2h) +
*Gautier:* work on chassis + help on the test robot (3h) +

== Monday 2022-11-7

*Gautier:* Design of the new robot's chassis (Central Unit mount, camera mount, battery mount...) (3.5h);
fixing the test robot (electronics, cable management...) for evaluation (4h) +
*Nathan:* Fixing the robot (electronics, cable management...) for evaluation (3h) +
*Malcom:* working on the code to align the robot with the ball and the target basket (3h) +
*Léon:* work on the redesign of the thrower and start to standardise all the CAD files I made (4h) +

== Wednesday 2022-11-9
*Gautier:* More work on the new chassis' battery and alarm mounts + XT60 sockets (3h) +
*Malcom:* Setting the thrower to aim at the basket(3h) +

== Thursday 2022-11-10
Test competition +

*Léon:* Standardization of CAD parts (2h) +
*Gautier:* Prep work and last minute fixes on test robot for test competition (3h)+
*Malcom:* Software tweaks and preparation of the robot for test competition (3h) +
*Nathan:* Worked on Altium (3h) +

== Monday 2022-11-14
Progress presentation +

== Tuesday 2022-11-15
*Gautier:* work on the chassis (side walls, camera mount improvements...) (4h) +

== Thursday 2022-11-17

*Nathan:* Finished all pieces (2h) +
*Léon:* redo all the badly made parts of the thrower (4h) +
*Malcom:*
*Gautier:* Absent +

== Monday 2022-11-21

*Nathan:* Finished schematics and tried to convert to pcb (3h) +
*Léon:* Finishing the renew of the thrower, 
improve the elements according to the feedback of the past presentation 
and build the system for the ball blocking system (4h) +
*Malcom:*
*Gautier:* Work on the chassis (1h) and review of the code with Malcom (2h) +

== Thursday 24-11-24
Test Competition 2 : The robot wasn't ready to receive referee commands so we bailed +
*Nathan:* Solved some problems (2h) +


== Saturday 2022-11-26

*Léon:* correct the small problems given in the review, and find solutions for the bigger ones. (2h) +

== Monday 2022-11-28
Progress presentation +

*Gautier:* Fixed the issues flagged after review. Improved the chassis (5h) +

== Thursday 2022-12-01
*Léon:* work on details of the CAD to get approval for milling, and start manufacturing on fusion(4h) +
*Malcom:* smooth the movement of the robot (4h) +
*Nathan:* finished schematics (3h) +
*Gautier:* XBOX controller support code (4h) +

== Monday 2022-12-05
*Léon:* change the whole assembly into a manufacturing model for the milling machine (3h) +
*Malcom:*improve the estimation of the distance (3h) +
*Nathan:* worked on pcb (4h) +
*Gautier:* Improvement of the distance estimation and thrower speed calculation + 3D printing chassis parts (3h)+

== Thursday 2022-12-08
*Léon:* Work on thrower accuracy, Milling and clean the components (9h) +
*Malcom:* get equation of the speed for the thrower (3h)+
*Nathan:*  tried to finish PCB (4h) +
*Gautier:* experimenting with thrower speed equation, implementation of depth sensing (3h) +

== Monday 2022-12-12
*Léon:* Assemble the components, make the threadings, print missing components (6h) +
*Nathan:* Assembly of the new robot (6h) +
*Gautier:* Assembly of the new robot (6h) +
*Malcom:* Assembly of the new robot (6h) +

